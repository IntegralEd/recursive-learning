<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recursive Learning</title>
    <link rel="stylesheet" href="assets/css/recursive-platform.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            background: radial-gradient(circle at top, #f9f9f9, #e0e0e0);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }
        img {
            max-width: 150px;
            border-radius: 50%;
            transition: transform 0.3s ease;
        }
        img:hover {
            transform: scale(1.05) rotate(5deg);
        }
        #main-container {
            max-width: 600px;
            width: 100%;
            padding: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        #top-section {
            text-align: center;
            margin-bottom: 20px;
        }
        h1, h2, h3 {
            color: #333;
        }
        input, textarea {
            display: block;
            margin: 10px 0 20px 10px;
            padding: 10px;
            width: 100%;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        input:focus, textarea:focus {
            border-color: #007BFF;
            outline: none;
        }
        button {
            padding: 10px 20px;
            background-color: #007BFF;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        button:hover {
            background-color: #0056b3;
        }
        p {
            font-style: italic;
            color: #666;
        }
        #form-container {
            display: none;
            flex-direction: column;
            align-items: flex-start;
            text-align: left;
        }
        #curious-button {
            cursor: pointer;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div id="main-container">
        <div id="top-section">
            <h1>Recursive Learning Platform</h1>
            <img src="assets/images/avatar.png" alt="Avatar">
            <div id="learning-container">
                <h2 id="spinner">Learning...</h2>
            </div>
            <div id="curious-button" onclick="toggleForm()">ðŸ‘€ Curious?</div>
            <div style="text-align: center;">&#x25BC;</div>
        </div>
        <div id="form-container">
            <h3>Welcome to the app. We're glad you found us!</h3>
            <input type="email" placeholder="Your Email" id="signup-email" />
            
            <h3>How did you learn about us?</h3>
            <p>We're hiding in beta until 2026.... someone must have clued you in</p>
            <textarea id="intake-source" placeholder="Supports rich text"></textarea>
            
            <h3>How do you hope to use recursive learning app?</h3>
            <p>We might sneak you into our beta if you're aligned in your requirements and values. 2025 we are supporting select users at various scales and stages of development. We learn, you learn, you get it...</p>
            <textarea id="intake-usage"></textarea>
            
            <h3>If you think we should know, how would you describe your role?</h3>
            <p>Folx are obsessed with official titles on forms, but you're about to enter a context-aware platform...</p>
            <textarea id="intake-role"></textarea>
            
            <button onclick="signup()">Sign Up</button>
        </div>
    </div>

    <div id="modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background-color:rgba(0,0,0,0.5); justify-content:center; align-items:center;">
        <div style="background-color:#fff; padding:20px; border-radius:8px; max-width:600px; width:90%;">
            <span id="close-modal" style="cursor:pointer; float:right;">&times;</span>
            <div id="modal-content"></div>
        </div>
    </div>

    <script>
        const texts = ["Learning", "Listening", "Reflecting", "Explaining", "Teaching", "Reaching", "Growing", "Evolving"];
        let currentIndex = 0;
        
        setInterval(() => {
            currentIndex = (currentIndex + 1) % texts.length;
            document.getElementById("spinner").innerText = texts[currentIndex];
        }, 1000); // change text every 1 second

        function toggleForm() {
            const formContainer = document.getElementById('form-container');
            formContainer.style.display = formContainer.style.display === 'block' ? 'none' : 'block';
        }

        function showModal(content) {
            const modal = document.getElementById('modal');
            const modalContent = document.getElementById('modal-content');
            modalContent.innerHTML = content;
            modal.style.display = 'flex';

            document.getElementById('close-modal').onclick = function() {
                modal.style.display = 'none';
            };
        }

        function handleWebhookResponse(data) {
            switch (data.status) {
                case 110:
                    alert(data.message); // Form received
                    break;
                case 120:
                    showModal(data.content); // Show loading content
                    break;
                case 200:
                    // Handle success, e.g., redirect or show success message
                    break;
                case 400:
                    // Handle context loaded, e.g., redirect to chat
                    break;
                default:
                    console.error('Unknown status:', data.status);
            }
        }

        function signup() {
            const email = document.getElementById('signup-email').value;
            const source = document.getElementById('intake-source').value;
            const usage = document.getElementById('intake-usage').value;
            const role = document.getElementById('intake-role').value;

            const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!email || !emailPattern.test(email)) {
                alert('Please enter a valid email.');
                return;
            }

            const payload = {
                User_ID: "----",
                Thread_ID: "----",
                Email: email,
                User_Intake_Item_01: source,
                User_Intake_Item_02: usage,
                User_Intake_Item_03: role,
                Org_ID: "recQvZ1Xcaiw1Ey8d",
                Source: "recursive.learning.app/index.html",
                Action_ID: "----"
            };

            fetch('https://hook.us1.make.com/gp1ykvaa7e7q5e3xnvjym2g9dkg9vl4y', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(payload)
            })
            .then(response => response.json())
            .then(handleWebhookResponse)
            .catch((error) => {
                console.error('Error:', error);
                alert('There was an error with your signup.');
            });
        }

        function pollWebhookStatus() {
            setInterval(() => {
                fetch('https://hook.us1.make.com/status-check', {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                })
                .then(response => response.json())
                .then(handleWebhookResponse)
                .catch((error) => {
                    console.error('Error checking status:', error);
                });
            }, 5000); // Check every 5 seconds
        }

        pollWebhookStatus();
    </script>
</body>
</html> 